/*Force version number in any old version*/Save.onLoad.add(function(save){save.state.history[save.state.index].variables.cvers="v0.08"})Save.onSave.add(function(save){if(setup.save_titles[passage()]){save.title=setup.save_titles[passage()]}else{save.title=passage()}})setup.save_titles={LocationHub:"The City",Room:"Your Room,Home:"Your House",Bathroom:"Your Bathroom,get MomRoom(){return `${State.variables.mom1.name}'s Room`},get Sis1Room(){return `${State.variables.sis1.name}'s Room`},get Sis2Room(){return `${State.variables.sis2.name}'s Room`},get Sis3Room(){return `${State.variables.sis3.name}'s Room`},LivingRoom:"The Living Room,Kitchen:"The Kitchen",Suburb:"Walking around the suburb",Park:"Walking around the park",Comic:"SplashArt Comics",College:"Livington College",Gym:"The Gym",DeansOffice:"Deans Office",English:"English Department",Business:"Business Department",Arts:"Art Department",Tech:"Technology Department",Psych:"Psychology Department",Chem:"Chemistry Department",Shopping:"Shopping District",BusinessSector:"Walking around the Business sector",SexShop:"The Hardware Store",Sonar:"Sonar Nightclub",Bar:"The Parched Throat",get 'Mom1:1-1'(){return `${State.variables.mom1.name} is in the living room`},get 'Mom1:1-2'(){return `${State.variables.mom1.name} is in the living room`},get 'Mom2:1-1'(){return `${State.variables.mom2.name} is getting what she deserves`},get 'Mom1:1-2'(){return `${State.variables.mom2.name} is getting what she deserves`},get 'Sis1:1-1'(){return `${State.variables.sis1.name}` is in her room},get 'Sis1:1-2'(){return `${State.variables.sis1.name}` is masturbating in her room},get 'Sis2:1-1'(){return You run into ${State.variables.sis2.name} +""},get 'Sis3:1-1'(){return `${State.variables.sis3.name}` is in her room},get 'Sis3:1-2'(){return `${State.variables.sis3.name}` is masturbating in her room},get 'BankW:1-1'(){return You're meeting ${State.variables.bankw.name} +""},get 'BankW:1-2'(){return You're playing with ${State.variables.bankw.name} +""},get 'BankW:2-1'(){return `${State.variables.bankw.name}` and Jasper are arguing"},get 'BankW:2-2'(){return `${State.variables.bankw.name}` and Jasper get with the program"},get 'BankC:1-1'(){return On a date with ${State.variables.bankc.name} +""},get 'BankC:1-2'(){return Filling ${State.variables.bankc.name} +"'s stomach"},get 'BankC:2-1'(){return `${State.variables.bankc.name}` wants to have a frank discussion"},get 'BankC:2-2'(){return Show ${State.variables.bankc.name} what your relationship really is"},get 'Nun1:1-1'(){return You're meeting ${State.variables.nun1.name} +""},get 'Nun1:2-1'(){return A problem with ${State.variables.nun1.name} +""},StoryPass1:"Something is wrong...",StoryPass2:"Who are they?",StoryPass3:"Friendly?",StoryPass4:"An honest chat with a demon",StoryPass5:"Plans are made to be changed",StoryPass6:"A discussion with Cain",}//FAVICON CHANGE $(document.head).append("<link rel='icon'href='images/Menu/Icon.png'>")//RIGHT UI BAR/*Create the Right UI Bar.  Swap the two lines below to start stowed instead of unstowed.*/var$rightUiBar=$('<div id="right-ui-bar"></div>').insertAfter("#ui-bar")/*var$rightUiBar=$('<div id="right-ui-bar" class="stowed"></div>').insertAfter("#ui-bar")*/var rightTray=$rightUiBar.append('<div id="right-ui-bar-tray"><button id="right-ui-bar-toggle" tabindex="0" title="Toggle the Right UI bar" aria-label="Toggle the Right UI bar" type="button"></button></div>')var rightBody=$rightUiBar.append('<div id="right-ui-bar-body"></div>')/*Attach the toggle button click.*/$rightUiBar.find('#right-ui-bar-toggle').ariaClick({label:"Toggle the Right UI bar"},function (){$rightUiBar.toggleClass('stowed')})/*Automatically show the contents of the StoryRightSidebar passage in the right-ui-bar-body element.*/postrender["Display Right Sidebar Contents"]=function (content,taskName){setPageElement('right-ui-bar-body','StoryRightSidebar')}/*To have your code stow the bar use:<<addclass "#right-ui-bar" "stowed">>To unstow the bar use:<<removeclass "#right-ui-bar" "stowed">>*///Chapel Text Box    (function (){//v1.1.1 'use strict'var characters=new Map()function addCharacter (name,displayname,icon){if(icon===undefined && displayname){icon=displayname    displayname=null}if (State.length){throw new Error('addCharacter()-> must be called before story starts')}if (!name || !icon){console.error('addCharacter()-> invalid arguments')return}if (characters.has(name)){console.error('addCharacter()-> overwriting character "'+name+'"')}characters.set(name,{displayName:displayname,image:icon})}function say ($output,character,text,imgSrc){//var$box=$(document.createElement('div')).addClass(Util.slugify(character)+'say')//portrait    var _img=characters.has(character)? characters.get(character).image:null           var$img=$(document.createElement('img')).attr('src',imgSrc || _img || '')if ($img.attr('src')&&$img.attr('src').trim()){$box.append($img)}//name and content boxes    var _name= character.toUpperFirst()if (characters.has(character)&& characters.get(character).displayName){_name=characters.get(character).displayName}$box.append($(document.createElement('p')).wiki(_name)).append($(document.createElement('p')).wiki(text))if ($output){if (!($output instanceof$)){$output=$($output)}$box.appendTo($output)}return$box}setup.say=say    setup.addCharacter=addCharacter        Macro.add('character',{//character macro    handler:function (){addCharacter(this.args[0],this.args[1],this.args[2])}})$(document).one(':passagestart',function (){//construct array of character names    var names=Array.from(characters.keys())names.push('say')//generate macros    Macro.add(names,{tags:null,handler:function (){if (this.name !== 'say'){say(this.output,this.name,this.payload[0].contents)}else {say(this.output,this.args[0],this.payload[0].contents,this.args[1])}}})})}())//SPEECH MACRO/*speech macro - Start*/Macro.add('speech',{tags:null,handler:function (){var id=this.args[0],name=id    if (this.args.length > 1)name=this.args[1]    var output='<div class="speech '+id+'">'output += '<span class="avatar"></span>'output += name+'<hr>'+this.payload[0].contents+'</div>'$(this.output).wiki(output)}})/*speech macro - End*///NOTIFICATION FOR ACHIEVEMENT    //notify.min.js,for SugarCube 2,by Chapel    //v1.1.1,2021-04-20,53d1a20e9321b3782a303cf7dbe00f5c51e947db    ;!function(){var s=/\d+m?s$/;function e(s,e,t){"string"==typeof s&&("number"!=typeof e&&(e=!1),$(document).trigger({type:":notify",message:s,delay:e,class:t||""}))}$(document.body).append("<div id='notify'></div>"),$(document).on(":notify",(function(s){s.message&&"string"==typeof s.message&&(s.message.trim(),s.class?"string"==typeof s.class?s.class="open macro-notify "+s.class:Array.isArray(s.class)?s.class="open macro-notify "+s.class.join(" "):s.class="open macro-notify":s.class="open macro-notify",s.delay?("number"!=typeof s.delay&&(s.delay=Number(s.delay)),Number.isNaN(s.delay)&&(s.delay=2e3)):s.delay=2e3,$("#notify").empty().wiki(s.message).addClass(s.class),setTimeout((function(){$("#notify").removeClass()}),s.delay))})),Macro.add("notify",{tags:null,handler:function(){var t=this.payload[0].contents,a=!1,n=!1;if(this.args.length>0){var i=s.test(this.args[0]);"number"==typeof this.args[0]||i?(a=i?Util.fromCssTime(this.args[0]):this.args[0],n=this.args.length>1&&this.args.slice(1).flatten()):n=this.args.flatten().join(" ")}e(t,a,n)}}),setup.notify=e}()//end notify.min.js/*Menu No Return*/$(document).on(':passagestart',function (ev){if (!ev.passage.tags.includes('noreturn')){${State.variables.return=ev}.passage.title}})/*Menu No Return end*//*Delayed Text code - Start*/$(document).on(':passagerender',function (ev){//Find all elements containing the delayed class.    var elems=$(ev.content).find('.delayed')//Appearance delay (in milliseconds)between each delayed text block.    var delay=1000//1 second fade-in    if (elems.length > 0){elems.each(function (i){$(this).delay(delay * (i+1)).fadeTo(delay,1)})}})/*Delayed Text code - End*//*! <<shake>>macro set for SugarCube 2.x*/!function(){"use strict";if("undefined"==typeof version||"undefined"==typeof version.title||"SugarCube"!==version.title||"undefined"==typeof version.major||version.major<2||"undefined"==typeof version.minor||version.minor<5)throw new Error("<<shake>>macro requires SugarCube 2.5.0 or greater,aborting load");Macro.add("shake",{tags:null,handler:function(){var duration=this.args.length>0?this.args[0]:1/0,shakeClass="shake";if(1/0!==duration)try{duration=Math.max(Engine.minDomActionDelay,Util.fromCssTime(duration))}catch(e){return this.error(e.message)}Config.debug&&this.debugView.modes({block:!0});var$wrapper=jQuery(document.createElement("span"));$wrapper.addClass("macro-"+this.name"+shakeClass).wiki(this.payload[0].contents).appendTo(this.output),1/0!==duration&&setTimeout(function(){$wrapper.removeClass(shakeClass)},Engine.minDomActionDelay+duration)}}),Macro.add(["shakescreen","shaketarget"],{handler:function(){var$targets,duration,shakeClass;if("shakescreen"===this.name)$targets=jQuery("#passages"),duration=this.args.length>0?this.args[0]:1/0,shakeClass="shake-block";else{if(0===this.args.length)return this.error("no selector specified");if($targets=jQuery(this.args[0]),0===$targets.length)return this.error('no elements matched the selector "'+this.args[0]+'"');duration=this.args.length>1?this.args[1]:1/0,shakeClass="block"===jQuery($targets[0]).css("display")?"shake-block":"shake"}if("stop"===duration)return void$targets.removeClass(shakeClass);if(1/0!==duration)try{duration=Math.max(Engine.minDomActionDelay,Util.fromCssTime(duration))}catch(e){return this.error(e.message)}$targets.addClass(shakeClass),1/0!==duration&&setTimeout(function(){$targets.removeClass(shakeClass)},Engine.minDomActionDelay+duration)}})}()/*Shake macro end*///message-macro.min.js,for SugarCube 2,by Chapel    //v1.0.1,2022-07-21,3bdbdfbe5ae47a46e4f4e52766d78701939ae9a6    ;setup.messageMacro={},setup.messageMacro.default="Help",Macro.add("message",{tags:null,handler:function(){var e=this.payload[0].contents,a=$(document.createElement("span")),s=$(document.createElement(this.args.includes("btn")?"button":"a")),t=$(document.createElement("span"));s.wiki(this.args.length>0&&"btn"!==this.args[0]?this.args[0]:setup.messageMacro.default).ariaClick(this.createShadowWrapper((function(){a.hasClass("open")?t.css("display","none").empty():t.css("display","block").wiki(e),a.toggleClass("open")}))),a.attr("id","macro-"+this.name+"-"+this.args.join("").replace(/[^A-Za-z0-9]/g,"")).addClass("message-text").append(s).append(t).appendTo(this.output)}})//end message-macro.min.js/*Link with class addition*/Macro.add(['ibutton','ilink'],{isAsync:true,tags:["comment"],handler(){if (this.args.length===0){return this.error(`no${this.name==='ibutton'? 'button':'link'}text specified`)}const$link=jQuery(document.createElement(this.name==='ibutton'? 'button':'a'))/** @type {string|undefined}*/let passage=undefined/** @type {string[]}*/let extraClasses=[]/** @type {string|undefined}*/let extraId        if (typeof this.args[0]==='object'){if (this.args[0].isImage){//Argument was in wiki image syntax.    const$image=jQuery(document.createElement('img')).attr('src',this.args[0].source).appendTo($link)if (this.args[0].hasOwnProperty('passage')){$image.attr('data-passage',this.args[0].passage)}if (this.args[0].hasOwnProperty('title')){$image.attr('title',this.args[0].title)}if (this.args[0].hasOwnProperty('align')){$image.attr('align',this.args[0].align)}passage=this.args[0].link}else {//Argument was in wiki link syntax. $link.append(document.createTextNode(this.args[0].text))passage=this.args[0].link}}else {//Argument was simply the link text. $link.wikiWithOptions({profile:'core'},this.args[0])let passageIdx=1    while(this.args.length > passageIdx){let val=String(this.args[passageIdx])if(val.startsWith(".")){extraClasses.push(val.substring(1))}else if(val.startsWith("#")){extraId=val.substring(1)}else {passage=val}++ passageIdx}}if (passage != null){//lazy equality for null $link.attr('data-passage',passage)if (Story.has(passage)){$link.addClass('link-internal')if (Config.addVisitedLinkClass && State.hasPlayed(passage)){$link.addClass('link-visited')}}else {$link.addClass('link-broken')}}else {$link.addClass('link-internal')}extraClasses.filter((c)=> !!c).forEach((c)=>$link.addClass(c))extraId &&$link.attr("id",extraId)$link    .addClass(`macro-${this.name}`).ariaClick({namespace:'.macros',one:passage != null //lazy equality for null},this.createShadowWrapper(    this.payload[0].contents !== ''? ()=> Wikifier.wikifyEval(this.payload[0].contents.trim()):null,passage != null //lazy equality for null    ? ()=> Engine.play(passage):null)).appendTo(this.output)}})/*hovertip v2.0 - Start*/window.UpdateHoverTipTxt=function (container){if (Engine.isIdle()){clearInterval(HTTIntervalID)if (container===undefined){container=$(document)}else {container=$(container)}var i,id,top,left,parent,elementList,element,hoverPos,boxPos,zindex    elementList=container.find('span[id^="hoverTipTxt"]')for (i=0i < elementList.lengthi++){element=$(elementList[i])id=elementList[i].id.substring(11)/*Find parent hoverTip item on the page.*/parent=$(container).find("#hoverTip"+(id))/*Position bottom of hoverTipTxt just above the parent.*/top=Math.round(-element.outerHeight()- 6)/*Center hoverTipTxt horizontally over parent.*/left=Math.round((parent.outerWidth()- element.outerWidth())/ 2)/*See if the hoverTip is contained by something with a higher z-index.*/zindex=element.css("z-index")if (zindex==="auto"){zindex=0}else {zindex=parseInt(zindex,10)}while (parent.parent()[0] !== document){if ((parent.parent().css("z-index")!== "auto")&& (parseInt(parent.parent().css("z-index"),10)> zindex)){/*Get container rect.*/boxPos=parent[0].getBoundingClientRect()break}parent=parent.parent()}/*Update position.*/element.css({top:top,left:left})hoverPos=element[0].getBoundingClientRect()/*Make sure the text isn't outside the bottom of the screen.*/if (hoverPos.top > window.innerHeight - hoverPos.height - 10){top -= hoverPos.top - (window.innerHeight - hoverPos.height - 10)}/*Make sure the text isn't outside the top of the screen.*/if (hoverPos.top < 4){top -= hoverPos.top - 4}/*Make sure the text isn't outside the right of the screen.*/if (hoverPos.left > window.innerWidth - hoverPos.width - 26){left -= hoverPos.left - (window.innerWidth - hoverPos.width - 26)}/*Make sure the text isn't outside the left of the screen.*/if (hoverPos.left < 4){left -= hoverPos.left - 4}/*Update position.*/element.css({top:Math.round(top),left:Math.round(left)})hoverPos=element[0].getBoundingClientRect()if (boxPos){/*Fit within dialog boxes and the like.*//*Make sure the text isn't outside the bottom of the box.*/if (hoverPos.top > boxPos.bottom - hoverPos.height - 10){top -= hoverPos.top - (boxPos.bottom - hoverPos.height - 10)}/*Make sure the text isn't outside the top of the box.*/if (hoverPos.top < boxPos.top+4){top -= hoverPos.top - (boxPos.top+4)}/*Make sure the text isn't outside the right of the box.*/if (hoverPos.left > boxPos.right - hoverPos.width - 26){left -= hoverPos.left - (boxPos.right - hoverPos.width - 26)}/*Make sure the text isn't outside the left of the box.*/if (hoverPos.left < boxPos.left+4){left -= hoverPos.left - boxPos.left - 4}/*Update position.*/element.css({top:Math.round(top),left:Math.round(left)})}}}else {clearInterval(HTTIntervalID)HTTIntervalID=setInterval(UpdateHoverTipTxt,300)}}/*Waits for passage to be fully rendered before doing anything.*/var HTTIntervalID=0 $(document).on(":passageend",function (ev){UpdateHoverTipTxt()})$(window).on("resize scroll",function (ev){clearInterval(HTTIntervalID)HTTIntervalID=setInterval(UpdateHoverTipTxt,300)})$("#ui-bar-toggle").on("click",function (ev){clearInterval(HTTIntervalID)HTTIntervalID=setInterval(UpdateHoverTipTxt,300)})/*<<hovertip>>macro*/Macro.add("hovertip",{tags:null,handler:function (){if (this.args.length > 0){var mw=""    if ((this.args.length > 1)&& (!isNaN(parseInt(this.args[1],10)))){mw='style="max-width:'+parseInt(this.args[1],10)+'px;"'}if (State.temporary.HoverTipCount == undefined){State.temporary.HoverTipCount=1}else {State.temporary.HoverTipCount++}while ($("#hoverTip"+State.temporary.HoverTipCount).length){/*Found an existing hoverTip.*/State.temporary.HoverTipCount++}var output='<span id="hoverTip'+State.temporary.HoverTipCount+    '" class="hoverTipTxt hoverTip" tabindex="0" '+    'onmouseenter="UpdateHoverTipTxt();">'+    this.payload[0].contents+'<span id="hoverTipTxt'+    State.temporary.HoverTipCount+'" class="hoverBox hoverTail"'+    mw+'>'+this.args[0]+'</span></span>'$(this.output).wiki(output)}else {$(this.output).wiki(this.payload[0].contents)}}})/*hovertip v2.0 - End*/